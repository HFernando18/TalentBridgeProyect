<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Iniciar sesión | Talent Bridge</title>
    <meta name="description"
        content="Inicia sesión en Talent Bridge para acceder a pasantías seguras y certificación digital.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Poppins:wght@500;600;700&family=Open+Sans:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="CSS/style.css">
</head>

<body class="font-opensans bg-slate-50">

    <!-- NAV -->
    <nav class="bg-white/80 backdrop-blur sticky top-0 z-50 border-b border-slate-100">
        <div class="mx-auto max-w-7xl px-6 lg:px-10 h-16 flex items-center justify-between">
            <a href="index.html" class="flex items-center gap-3">
                <img src="img/logo/Talent_Bridge_FH_Final.svg" alt="Talent Bridge" class="h-12" loading="lazy" />
                <span class="font-poppins font-semibold text-primary hidden sm:inline">Talent Bridge</span>
            </a>
        </div>
    </nav>

    <!-- LOGIN FORM -->
    <main class="flex items-center justify-center min-h-screen px-6 py-4 bg-gradient-to-r from-primary to-secondary">
        <div
            class="bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl w-full max-w-md p-10 space-y-8 transition-all duration-300">
            <!-- Logo -->
            <div class="text-center">
                <img src="img/icons/login.svg" alt="Login" class="h-20 mx-auto opacity-90" />
                <h1 class="mt-4 text-3xl font-montserrat font-extrabold text-primary">Inicia sesión</h1>
                <p id="login-desc" class="text-sm text-gray-600">Selecciona el tipo de cuenta e ingresa tus credenciales
                </p>
            </div>

            <!-- Selector de tipo de cuenta -->
            <div
                class="relative bg-slate-200 rounded-full flex justify-between items-center p-1 text-sm font-poppins overflow-hidden group">
                <span id="indicator"
                    class="absolute top-1 left-1 h-[calc(100%-0.5rem)] w-1/3 rounded-full bg-secondary opacity-80 shadow-md transition-all duration-300 ease-in-out"></span>
                <button id="btnEst"
                    class="tab-btn flex-1 py-2 relative z-10 text-primary font-semibold transition">Estudiante</button>
                <button id="btnEmp"
                    class="tab-btn flex-1 py-2 relative z-10 text-gray-700 hover:text-primary transition">Empresa</button>
                <button id="btnUni"
                    class="tab-btn flex-1 py-2 relative z-10 text-gray-700 hover:text-primary transition">Universidad</button>
            </div>

            <!-- Formulario -->
            <form id="loginForm" class="space-y-5">
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700">Correo electrónico</label>
                    <input id="email" type="email" required placeholder="tu@correo.com"
                        class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-secondary">
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700">Contraseña</label>
                    <input id="password" type="password" required placeholder="********"
                        class="mt-1 w-full px-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-secondary">
                </div>
                <div class="flex items-center justify-between text-sm">
                    <label class="flex items-center gap-2"><input type="checkbox"
                            class="h-4 w-4 text-secondary border-gray-300 rounded"> Recordarme</label>
                    <a href="#" class="text-primary hover:text-secondary">¿Olvidaste tu contraseña?</a>
                </div>
                <button type="submit"
                    class="w-full bg-primary text-white font-poppins font-semibold py-3 rounded-lg hover:bg-opacity-90 transition">Ingresar</button>
            </form>

            <!-- Divider -->
            <div id="divider" class="flex items-center gap-3">
                <hr class="flex-1 border-gray-300">
                <span class="text-sm text-gray-500">o continúa con</span>
                <hr class="flex-1 border-gray-300">
            </div>

            <!-- Botones sociales -->
            <div id="socialButtons" class="grid gap-3">
                <button
                    class="flex items-center justify-center gap-3 w-full bg-white border border-gray-300 rounded-lg py-3 shadow hover:bg-gray-50 transition">
                    <img src="img/icons/Google.svg" alt="Google" class="h-5 w-5">
                    <span class="text-gray-700 font-medium">Iniciar sesión con Google</span>
                </button>
                <button
                    class="flex items-center justify-center gap-3 w-full bg-white border border-gray-300 rounded-lg py-3 shadow hover:bg-gray-50 transition">
                    <img src="img/icons/Microsoft.svg" alt="Microsoft" class="h-5 w-5">
                    <span class="text-gray-700 font-medium">Iniciar sesión con Microsoft</span>
                </button>
            </div>

            <!-- Registro -->
            <p class="text-center text-sm text-gray-600">¿No tienes cuenta?
                <a href="register.html" class="text-primary font-semibold hover:text-secondary">Regístrate gratis</a>
            </p>
        </div>
    </main>
<script src="JS/auth.js"></script>
    <script>
        // Definición de variables
        const tabs = document.querySelectorAll(".tab-btn");
        const indicator = document.getElementById("indicator");
        const divider = document.getElementById("divider");
        const social = document.getElementById("socialButtons");
        const desc = document.getElementById("login-desc");        

        // Cambio de tipo de cuenta
        tabs.forEach((btn, index) => {
            btn.addEventListener("click", () => {
                tabs.forEach(t => t.classList.remove("text-primary", "font-semibold"));
                btn.classList.add("text-primary", "font-semibold");
                indicator.style.transform = `translateX(${index * 100}%)`;

                if (btn.id === "btnEst") {
                    desc.textContent = "Accede a tu panel de estudiante y encuentra pasantías seguras.";
                    social.style.display = "grid";
                    divider.style.display = "flex";
                } else if (btn.id === "btnEmp") {
                    desc.textContent = "Accede a tu panel de empresa para publicar vacantes y gestionar postulaciones.";
                    social.style.display = "none";
                    divider.style.display = "none";
                } else if (btn.id === "btnUni") {
                    desc.textContent = "Accede a tu panel universitario para gestionar prácticas y convenios.";
                    social.style.display = "none";
                    divider.style.display = "none";
                }
            });
        });

    // --- Toast flotante animado ---
    function showToast(message, type = "success") {
      const toast = document.createElement("div");
      toast.className = `toast ${type}`;
      toast.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          ${type === "success"
          ? `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />`
          : `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />`}
        </svg>
        <span>${message}</span>
      `;
      document.body.appendChild(toast);
      setTimeout(() => toast.classList.add("show"), 100);
      setTimeout(() => {
        toast.classList.remove("show");
        setTimeout(() => toast.remove(), 400);
      }, 3000);
    }

        document.getElementById("loginForm").addEventListener("submit", e => {
            e.preventDefault();
            const email = document.getElementById("email").value.trim();
            const pass = document.getElementById("password").value.trim();
            const btn = e.target.querySelector("button[type='submit']");
            const originalText = btn.innerHTML;
            const active = document.querySelector(".tab-btn.text-primary");
            const tipo = active.id === "btnEst" ? "estudiante" : active.id === "btnEmp" ? "empresa" : "universidad";


            btn.innerHTML = `
        <div class="flex items-center justify-center gap-2">
          <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
          </svg>
          <span>Verificando...</span>
        </div>`;
            btn.disabled = true;

            setTimeout(() => {
                const user = loginUser(email, pass, tipo);

                if (user) {
                    showToast("✅ Inicio de sesión exitoso. Redirigiendo...", "success");
                    setTimeout(() => {
                    localStorage.setItem("usuarioActivo", JSON.stringify(user));
                    if (user.tipo === "estudiante") window.location.href = "dashboard_estudiante.html";
                    else if (user.tipo === "empresa") window.location.href = "dashboard_empresa.html";
                    else window.location.href = "dashboard_universidad.html";
                    }, 1800);
                } else {
                    showToast("Credenciales incorrectas o tipo de cuenta no coincide.", "error");
                }

                btn.innerHTML = originalText;
                btn.disabled = false;
            }, 2000);
        });
    </script>
</body>

</html>