<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Registro | Talent Bridge</title>
  <meta name="description"
    content="Reg√≠strate en Talent Bridge para acceder a pasant√≠as seguras, publicar vacantes o gestionar pr√°cticas universitarias.">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Poppins:wght@500;600;700&family=Open+Sans:wght@400;500&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="CSS/style.css">
</head>

<body class="font-opensans bg-gradient-to-r from-primary to-secondary min-h-screen flex flex-col">

  <!-- NAV -->
  <nav class="bg-white/80 backdrop-blur sticky top-0 z-50 border-b border-slate-100">
    <div class="mx-auto max-w-7xl px-6 lg:px-10 h-16 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <img src="img/logo/Talent_Bridge_FH_Final.svg" alt="Talent Bridge" class="h-12" />
        <span class="font-poppins font-semibold text-primary hidden sm:inline">Talent Bridge</span>
      </a>
    </div>
  </nav>

  <!-- REGISTRO -->
  <main class="flex items-center justify-center min-h-screen px-6 py-4 bg-gradient-to-r from-primary to-secondary">
    <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl w-full max-w-3xl p-10 space-y-8 transition-all duration-300">

      <!-- Encabezado -->
      <div class="text-center">
        <img src="img/icons/register.svg" alt="Register Icon" class="h-20 mx-auto opacity-90" />
        <h1 class="mt-4 text-2xl font-montserrat font-extrabold text-primary">Crea tu cuenta</h1>
        <p class="text-sm text-gray-600">Selecciona el tipo de cuenta e ingresa tus datos</p>
      </div>

      <!-- Interruptor -->
      <div class="relative bg-slate-200 rounded-full flex justify-between items-center p-1 text-sm font-poppins overflow-hidden group">
        <span id="indicator"
          class="absolute top-1 left-1 h-[calc(100%-0.5rem)] w-1/3 rounded-full bg-secondary opacity-80 shadow-md transition-all duration-300 ease-in-out">
        </span>
        <button id="btnEstudiante" class="tab-btn flex-1 py-2 relative z-10 text-primary font-semibold transition">Estudiante</button>
        <button id="btnEmpresa" class="tab-btn flex-1 py-2 relative z-10 text-gray-700 hover:text-primary transition">Empresa</button>
        <button id="btnUniversidad" class="tab-btn flex-1 py-2 relative z-10 text-gray-700 hover:text-primary transition">Universidad</button>
      </div>

      <!-- Formulario -->
      <form id="registerForm" class="space-y-5 mt-6">
        <div>
          <label class="block text-sm font-medium text-gray-700">Correo electr√≥nico</label>
          <input id="email" type="email" placeholder="tu@correo.com" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Contrase√±a</label>
          <input id="password" type="password" placeholder="********" required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700">Nombre completo / Empresa / Universidad</label>
          <input id="nombre" type="text" placeholder="Ej. Juan P√©rez o Tech Solutions S.A." required
            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary" />
        </div>
        <button type="submit"
          class="w-full bg-primary text-white font-poppins font-semibold py-3 rounded-lg hover:bg-opacity-90 transition">
          Registrarme
        </button>
      </form>

      <!-- Tabla de usuarios -->
      <div class="mt-8">
        <div class="flex items-center justify-between mb-3">
          <h2 class="font-semibold text-primary text-lg">üë• Usuarios registrados</h2>
          <span id="userCount" class="text-sm text-gray-600"></span>
        </div>
        <div class="overflow-x-auto rounded-lg border border-gray-200">
          <table class="min-w-full bg-white text-sm text-left border-collapse">
            <thead class="bg-gray-100">
              <tr>
                <th class="py-2 px-4 border-b">#</th>
                <th class="py-2 px-4 border-b">Nombre</th>
                <th class="py-2 px-4 border-b">Correo</th>
                <th class="py-2 px-4 border-b">Tipo</th>
                <th class="py-2 px-4 border-b">Fecha</th>
              </tr>
            </thead>
            <tbody id="userTable" class="divide-y divide-gray-200"></tbody>
          </table>
        </div>
        <div class="mt-4 flex justify-end">
          <button id="clearUsers" class="bg-red-500 hover:bg-red-600 text-white text-sm font-medium px-4 py-2 rounded-lg">
            üóëÔ∏è Limpiar registros
          </button>
        </div>
      </div>

      <!-- Iniciar sesi√≥n -->
      <p class="text-center text-sm text-gray-600 mt-4">
        ¬øYa tienes cuenta?
        <a href="login.html" class="text-primary font-semibold hover:text-secondary">Inicia sesi√≥n aqu√≠</a>
      </p>
    </div>
  </main>

  <script>
    // --- UTILIDADES DE USUARIOS ---
    const MAX_USERS = 7;

    function getUsers() {
      return JSON.parse(localStorage.getItem("usuariosTalentBridge")) || [];
    }
    function saveUsers(users) {
      localStorage.setItem("usuariosTalentBridge", JSON.stringify(users));
    }
    function addUser(nuevo) {
      let users = getUsers();
      if (users.some(u => u.email === nuevo.email)) {
        return { success: false, message: "Ya existe un usuario con ese correo." };
      }
      users.push(nuevo);
      if (users.length > MAX_USERS) users.shift();
      saveUsers(users);
      return { success: true };
    }

    // --- VARIABLES ---
    const tabs = document.querySelectorAll(".tab-btn");
    const indicator = document.getElementById("indicator");
    let tipo = "estudiante";

    tabs.forEach((btn, index) => {
      btn.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("text-primary", "font-semibold"));
        btn.classList.add("text-primary", "font-semibold");
        indicator.style.transform = `translateX(${index * 100}%)`;
        tipo = btn.id === "btnEstudiante" ? "estudiante" : btn.id === "btnEmpresa" ? "empresa" : "universidad";
      });
    });

    // --- REGISTRO ---
    document.getElementById("registerForm").addEventListener("submit", e => {
      e.preventDefault();
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      const nombre = document.getElementById("nombre").value.trim();
      const fecha = new Date().toLocaleDateString("es-EC");

      const nuevoUsuario = { email, password, nombre, tipo, fecha };
      const btn = e.target.querySelector("button[type='submit']");
      const original = btn.innerHTML;

      btn.innerHTML = `
        <div class="flex items-center justify-center gap-2">
          <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
          </svg>
          <span>Registrando...</span>
        </div>`;
      btn.disabled = true;

      setTimeout(() => {
        const result = addUser(nuevoUsuario);
        btn.innerHTML = original;
        btn.disabled = false;

        if (result.success) {
          showToast("‚úÖ Registro exitoso", "success");
          e.target.reset();
          renderUsers();
        } else {
          showToast("‚ö†Ô∏è " + result.message, "error");
        }
      }, 1800);
    });

    // --- MOSTRAR USUARIOS ---
    function renderUsers() {
      const tbody = document.getElementById("userTable");
      const count = document.getElementById("userCount");
      const users = getUsers();
      tbody.innerHTML = "";
      count.textContent = `(${users.length} / ${MAX_USERS}) registrados`;

      if (users.length === 0) {
        tbody.innerHTML = `<tr><td colspan="5" class="text-center py-3 text-gray-500 italic">Sin usuarios a√∫n.</td></tr>`;
        return;
      }

      users.forEach((u, i) => {
        tbody.innerHTML += `
          <tr>
            <td class="py-2 px-4">${i + 1}</td>
            <td class="py-2 px-4">${u.nombre}</td>
            <td class="py-2 px-4">${u.email}</td>
            <td class="py-2 px-4 capitalize">${u.tipo}</td>
            <td class="py-2 px-4">${u.fecha}</td>
          </tr>`;
      });
    }

    // --- LIMPIAR USUARIOS ---
    document.getElementById("clearUsers").addEventListener("click", () => {
      if (confirm("¬øDeseas eliminar todos los registros?")) {
        localStorage.removeItem("usuariosTalentBridge");
        renderUsers();
      }
    });

    // --- TOAST ---
    function showToast(message, type = "success") {
      const toast = document.createElement("div");
      toast.className = `fixed bottom-6 right-6 flex items-center gap-3 px-4 py-3 rounded-lg shadow-lg text-white z-50 transition-all duration-500 transform translate-y-10 opacity-0
        ${type === "success" ? "bg-green-600" : "bg-red-600"}`;
      toast.innerHTML = `<span>${message}</span>`;
      document.body.appendChild(toast);
      setTimeout(() => toast.classList.remove("translate-y-10", "opacity-0"), 100);
      setTimeout(() => {
        toast.classList.add("translate-y-10", "opacity-0");
        setTimeout(() => toast.remove(), 500);
      }, 3000);
    }

    // Cargar usuarios al inicio
    renderUsers();
  </script>

</body>
<script src="JS/auth.js"></script>
</html>
